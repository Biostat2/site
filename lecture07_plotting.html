<!DOCTYPE html>
<html>
<head>
  <title>Data plotting</title>

  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />



  <meta name="date" content="2017-10-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Data plotting',
                        subtitle: 'ggplot2',
                useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                        favIcon: 'lecture07_plotting_files/logo.png',
              },

      // Author information
      presenters: [
            {
        name:  'A. Ginolhac, E. Koncina' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }
  </style>

  <link rel="stylesheet" href="css/tweaks.css" type="text/css" />

  <link href="site_libs/ioslides-13.5.1/fonts/fonts.css" rel="stylesheet" />
  <link href="site_libs/ioslides-13.5.1/theme/css/default.css" rel="stylesheet" />
  <link href="site_libs/ioslides-13.5.1/theme/css/phone.css" rel="stylesheet" />
  <script src="site_libs/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/prettify.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/hammer.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/slide-controller.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/slide-deck.js"></script>
  <link href="site_libs/iosp-0.1/css/iosp.css" rel="stylesheet" />
  <script src="site_libs/iosp-0.1/js/lang-r.js"></script>
  <style type="text/css">
  /* bg-orange colour */
  
  .bg-orange {
    background-color: #FF8C00;
    color: #000000;
  }
  
  .bg-orange a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-orange a:hover {
    color: #000000 !important;
  }
  
  .box.bg-orange {
    border: 2px solid #7F4600;
  }
  
  .box.bg-orange > h3:first-child {
    background-color: #7F4600;
    color: #FFFFFF;
  }
                          
  blockquote.bg-orange::before {
    color : #7F4600;
  }
   
  blockquote.bg-orange {
    color: #000000;
    border-color: #7F4600;
  }
  
  .box.bg-orange > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-orange > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-orange > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-orange > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-orange > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-orange code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-slate colour */
  
  .bg-slate {
    background-color: #7A67EE;
    color: #FFFFFF;
  }
  
  .bg-slate a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .bg-slate a:hover {
    color: #FFFFFF !important;
  }
  
  .box.bg-slate {
    border: 2px solid #3D3377;
  }
  
  .box.bg-slate > h3:first-child {
    background-color: #3D3377;
    color: #FFFFFF;
  }
                          
  blockquote.bg-slate::before {
    color : #3D3377;
  }
   
  blockquote.bg-slate {
    color: #FFFFFF;
    border-color: #3D3377;
  }
  
  .box.bg-slate > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-slate > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-slate > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-slate > hgroup > h2 {
    color: rgba(255, 255, 255, 0.8);
  }
  
  slide.bg-slate > hgroup > h3 {
    color: rgba(255, 255, 255, 0.7);
  }
  
  .bg-slate code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  /* bg-yellow colour */
  
  .bg-yellow {
    background-color: #FFEC8B;
    color: #000000;
  }
  
  .bg-yellow a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-yellow a:hover {
    color: #000000 !important;
  }
  
  .box.bg-yellow {
    border: 2px solid #EEB422;
  }
  
  .box.bg-yellow > h3:first-child {
    background-color: #EEB422;
    color: #000000;
  }
                          
  blockquote.bg-yellow::before {
    color : #EEB422;
  }
   
  blockquote.bg-yellow {
    color: #000000;
    border-color: #EEB422;
  }
  
  .box.bg-yellow > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  
  .box.bg-yellow > h3:first-child > a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .box.bg-yellow > h3:first-child > a:hover {
    color: #000000 !important;
  }
    
  slide.bg-yellow > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-yellow > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-yellow code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-grgold colour */
  
  .bg-grgold {
    background-color: #008B45;
    color: #FFFFFF;
  }
  
  .bg-grgold a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .bg-grgold a:hover {
    color: #FFFFFF !important;
  }
  
  .box.bg-grgold {
    border: 2px solid #004522;
  }
  
  .box.bg-grgold > h3:first-child {
    background-color: #004522;
    color: #FFD700;
  }
                          
  blockquote.bg-grgold::before {
    color : #004522;
  }
   
  blockquote.bg-grgold {
    color: #FFFFFF;
    border-color: #004522;
  }
  
  .box.bg-grgold > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-grgold > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-grgold > h3:first-child > a:hover {
    color: #FFD700 !important;
  }
    
  slide.bg-grgold > hgroup > h2 {
    color: rgba(255, 255, 255, 0.8);
  }
  
  slide.bg-grgold > hgroup > h3 {
    color: rgba(255, 255, 255, 0.7);
  }
  
  .bg-grgold code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  /* bg-pink2 colour */
  
  .bg-pink2 {
    background-color: #EEA9B8;
    color: #000000;
  }
  
  .bg-pink2 a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-pink2 a:hover {
    color: #000000 !important;
  }
  
  .box.bg-pink2 {
    border: 2px solid #77545C;
  }
  
  .box.bg-pink2 > h3:first-child {
    background-color: #77545C;
    color: #FFFFFF;
  }
                          
  blockquote.bg-pink2::before {
    color : #77545C;
  }
   
  blockquote.bg-pink2 {
    color: #000000;
    border-color: #77545C;
  }
  
  .box.bg-pink2 > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-pink2 > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-pink2 > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-pink2 > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-pink2 > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-pink2 code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-aquamarine2 colour */
  
  .bg-aquamarine2 {
    background-color: #76EEC6;
    color: #000000;
  }
  
  .bg-aquamarine2 a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-aquamarine2 a:hover {
    color: #000000 !important;
  }
  
  .box.bg-aquamarine2 {
    border: 2px solid #3B7763;
  }
  
  .box.bg-aquamarine2 > h3:first-child {
    background-color: #3B7763;
    color: #FFFFFF;
  }
                          
  blockquote.bg-aquamarine2::before {
    color : #3B7763;
  }
   
  blockquote.bg-aquamarine2 {
    color: #000000;
    border-color: #3B7763;
  }
  
  .box.bg-aquamarine2 > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-aquamarine2 > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-aquamarine2 > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-aquamarine2 > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-aquamarine2 > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-aquamarine2 code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-grayblue colour */
  
  .bg-grayblue {
    background-color: #BFCCD7;
    color: #000000;
  }
  
  .bg-grayblue a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-grayblue a:hover {
    color: #000000 !important;
  }
  
  .box.bg-grayblue {
    border: 2px solid #5F666B;
  }
  
  .box.bg-grayblue > h3:first-child {
    background-color: #5F666B;
    color: #FFFFFF;
  }
                          
  blockquote.bg-grayblue::before {
    color : #5F666B;
  }
   
  blockquote.bg-grayblue {
    color: #000000;
    border-color: #5F666B;
  }
  
  .box.bg-grayblue > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-grayblue > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-grayblue > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-grayblue > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-grayblue > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-grayblue code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-yellow2 colour */
  
  .bg-yellow2 {
    background-color: #EEB422;
    color: #000000;
  }
  
  .bg-yellow2 a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-yellow2 a:hover {
    color: #000000 !important;
  }
  
  .box.bg-yellow2 {
    border: 2px solid #EEB422;
  }
  
  .box.bg-yellow2 > h3:first-child {
    background-color: #EEB422;
    color: #000000;
  }
                          
  blockquote.bg-yellow2::before {
    color : #EEB422;
  }
   
  blockquote.bg-yellow2 {
    color: #000000;
    border-color: #EEB422;
  }
  
  .box.bg-yellow2 > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  
  .box.bg-yellow2 > h3:first-child > a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .box.bg-yellow2 > h3:first-child > a:hover {
    color: #000000 !important;
  }
    
  slide.bg-yellow2 > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-yellow2 > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-yellow2 code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-green2 colour */
  
  .bg-green2 {
    background-color: #00EE00;
    color: #000000;
  }
  
  .bg-green2 a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-green2 a:hover {
    color: #000000 !important;
  }
  
  .box.bg-green2 {
    border: 2px solid #007700;
  }
  
  .box.bg-green2 > h3:first-child {
    background-color: #007700;
    color: #FFFFFF;
  }
                          
  blockquote.bg-green2::before {
    color : #007700;
  }
   
  blockquote.bg-green2 {
    color: #000000;
    border-color: #007700;
  }
  
  .box.bg-green2 > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-green2 > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-green2 > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-green2 > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-green2 > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-green2 code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-red colour */
  
  .bg-red {
    background-color: #FFAD99;
    color: #000000;
  }
  
  .bg-red a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-red a:hover {
    color: #000000 !important;
  }
  
  .box.bg-red {
    border: 2px solid #991F00;
  }
  
  .box.bg-red > h3:first-child {
    background-color: #991F00;
    color: #FFFFFF;
  }
                          
  blockquote.bg-red::before {
    color : #991F00;
  }
   
  blockquote.bg-red {
    color: #000000;
    border-color: #991F00;
  }
  
  .box.bg-red > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-red > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-red > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-red > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-red > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-red code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-green colour */
  
  .bg-green {
    background-color: #ADEBAD;
    color: #000000;
  }
  
  .bg-green a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-green a:hover {
    color: #000000 !important;
  }
  
  .box.bg-green {
    border: 2px solid #1F7A1F;
  }
  
  .box.bg-green > h3:first-child {
    background-color: #1F7A1F;
    color: #FFFFFF;
  }
                          
  blockquote.bg-green::before {
    color : #1F7A1F;
  }
   
  blockquote.bg-green {
    color: #000000;
    border-color: #1F7A1F;
  }
  
  .box.bg-green > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-green > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-green > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-green > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-green > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-green code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-blue colour */
  
  .bg-blue {
    background-color: #99D6FF;
    color: #000000;
  }
  
  .bg-blue a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-blue a:hover {
    color: #000000 !important;
  }
  
  .box.bg-blue {
    border: 2px solid #005C99;
  }
  
  .box.bg-blue > h3:first-child {
    background-color: #005C99;
    color: #FFFFFF;
  }
                          
  blockquote.bg-blue::before {
    color : #005C99;
  }
   
  blockquote.bg-blue {
    color: #000000;
    border-color: #005C99;
  }
  
  .box.bg-blue > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-blue > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-blue > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-blue > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-blue > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-blue code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-gray colour */
  
  .bg-gray {
    background-color: #FAFAFA;
    color: #000000;
  }
  
  .bg-gray a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-gray a:hover {
    color: #000000 !important;
  }
  
  .box.bg-gray {
    border: 2px solid #CECECE;
  }
  
  .box.bg-gray > h3:first-child {
    background-color: #CECECE;
    color: #000000;
  }
                          
  blockquote.bg-gray::before {
    color : #CECECE;
  }
   
  blockquote.bg-gray {
    color: #000000;
    border-color: #CECECE;
  }
  
  .box.bg-gray > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  
  .box.bg-gray > h3:first-child > a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .box.bg-gray > h3:first-child > a:hover {
    color: #000000 !important;
  }
    
  slide.bg-gray > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-gray > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-gray code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-white colour */
  
  .bg-white {
    background-color: #FFFFFF;
    color: #000000;
  }
  
  .bg-white a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .bg-white a:hover {
    color: #000000 !important;
  }
  
  .box.bg-white {
    border: 2px solid #CECECE;
  }
  
  .box.bg-white > h3:first-child {
    background-color: #CECECE;
    color: #000000;
  }
                          
  blockquote.bg-white::before {
    color : #CECECE;
  }
   
  blockquote.bg-white {
    color: #000000;
    border-color: #CECECE;
  }
  
  .box.bg-white > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  
  .box.bg-white > h3:first-child > a {
    color: rgb(42, 124, 223);
    border-bottom: 1px solid rgba(42, 124, 223, 0.5);
  }
  
  .box.bg-white > h3:first-child > a:hover {
    color: #000000 !important;
  }
    
  slide.bg-white > hgroup > h2 {
    color: rgba(0, 0, 0, 0.8);
  }
  
  slide.bg-white > hgroup > h3 {
    color: rgba(0, 0, 0, 0.7);
  }
  
  .bg-white code {
    background-color: rgba(255, 255, 255, 0.3);
  }
  /* bg-cobalt colour */
  
  .bg-cobalt {
    background-color: #2B557A;
    color: #FFFFFF;
  }
  
  .bg-cobalt a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .bg-cobalt a:hover {
    color: #FFFFFF !important;
  }
  
  .box.bg-cobalt {
    border: 2px solid #002240;
  }
  
  .box.bg-cobalt > h3:first-child {
    background-color: #002240;
    color: #FFFFFF;
  }
                          
  blockquote.bg-cobalt::before {
    color : #002240;
  }
   
  blockquote.bg-cobalt {
    color: #FFFFFF;
    border-color: #002240;
  }
  
  .box.bg-cobalt > h3:first-child > code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  
  .box.bg-cobalt > h3:first-child > a {
    color: rgb(200, 240, 250);
    border-bottom: 1px solid rgba(200, 240, 250, 0.5);
  }
  
  .box.bg-cobalt > h3:first-child > a:hover {
    color: #FFFFFF !important;
  }
    
  slide.bg-cobalt > hgroup > h2 {
    color: rgba(255, 255, 255, 0.8);
  }
  
  slide.bg-cobalt > hgroup > h3 {
    color: rgba(255, 255, 255, 0.7);
  }
  
  .bg-cobalt code {
    background-color: rgba(255, 255, 255, 0.7);
  }
  </style>

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <aside class="gdbar"><img src="lecture07_plotting_files/logo.png"></aside>
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">18 October 2017</p>
          </hgroup>
  </slide>

<div id="unnamed-chunk-1">
<style type="text/css">
.bg-green2 > h3:first-child > a:hover,
.bg-green2 > h3:first-child > a {
  color: white !important;
}

.bg-grgold a:hover,
.bg-grgold a {
  color: white !important;
}

/* from https://csswizardry.com/2010/02/mutiple-column-lists-using-one-ul/ */
.col-list ul {
  overflow: hidden;
}

.col-list li {
  float: left;
  display: inline;
  padding-left: 50px;
}

.col-list li:before {
    content: "\2022";
    font-size: 150%;
}

.c2 li {
  width: 50%;
}

.c3 li {
  width: 33.333%;
}
</style></div>

<slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>ggplot2</h2></hgroup><article  id="ggplot2" class="smaller ">

<img src='img/07/ggplot2_overview.jpg' title='fig:'/>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Learning objectives</h2></hgroup><article  id="learning-objectives" class="smaller vs3">

<div class = 'box col col-10 offset-1 bg-red icon'><h3>You will learn to:</h3><div class = 'box-body'>

<img src='img/00/kt.png' title='fig:'/>

<p>By the end you should be able to:</p>

<ul>
<li>Understand the basic grammar of ggplot2 (data, geoms, aesthetics, facets).</li>
<li>Make quick exploratory plots of your multidimensional data.</li>
<li>Know how to find help on <code>ggplot2</code> when you run into problems.</li>
</ul>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Before, there was <code>ggplot1</code></h2></hgroup><article  id="before-there-was-ggplot1" class="smaller build">

<p>Released in <strong>2005</strong> until <strong>2008</strong> by <a href='https://github.com/hadley/ggplot1' title=''>Hadley Wickham</a>.</p>

<blockquote>
<p>If the pipe ( %&gt;% in 2014) had been invented before, <code>ggplot2</code> would have never existed <cite> Hadley Wickham</p></cite>
</blockquote>

<div class = 'box col col-6 bg-yellow stretch'><h3>Original syntax</h3><div class = 'box-body'>

<div id="unnamed-chunk-2" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'># devtools::install_github(&quot;hadley/ggplot1&quot;)
library(ggplot1)
p &lt;- ggplot(mtcars, list(x = mpg, y = wt))
# need temp p object to avoid too many ()&#39;s
scbrewer(ggpoint(p, list(colour = gear)))</pre></div>

</div></div><div class = 'box col col-6 bg-aquamarine2'><h3>with the pipe</h3><div class = 'box-body'>

<div id="unnamed-chunk-3" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>library(ggplot1)
mtcars %&gt;% 
  ggplot(list(x = mpg, y = wt)) %&gt;% 
  ggpoint(list(colour = gear)) %&gt;% 
  scbrewer()</pre></div>

</div></div><div class = 'box col col-8 offset-1 bg-grgold stretch'><h3>ggplot2</h3><div class = 'box-body'>

<div id="unnamed-chunk-4" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>library(ggplot2)
mtcars %&gt;% 
  ggplot(aes(x = mpg, y = wt)) + 
  geom_point(aes(colour = as.factor(gear))) +
  scale_color_brewer(&quot;gear&quot;, type = &quot;qual&quot;)</pre></div>

</div></div><div class = 'box col col-3 bg-red stretch'><h3>Issue</h3><div class = 'box-body'>

<p>Introduced a break in the workflow from <code>%&gt;%</code> to <code>+</code></p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>What is <code>ggplot2</code> </h2><h3> released in 2007</h3></hgroup><article  id="what-is-ggplot2-released-in-2007" class="smaller vs2 build">

<ul>
<li><code>ggplot2</code> stands for <strong>g</strong>rammar of <strong>graphics</strong> plot version 2

<ul>
<li>Inspired by Leland Wilkinsons work on the <a href='https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448' title=''>grammar of graphics</a> in 2005.</li>
<li>The idea is to split a graph into layers: for example axis, curve(s), labels.</li>
<li><strong>3</strong> main elements are necessary: <strong>data</strong>, <strong>aesthetics</strong> and at least one <strong>geometry</strong></li>
</ul></li>
</ul>

<div class = 'col col-8'>

<img src='img/07/graphic_objects.png' title='fig:'/>

</div><div class = 'col col-4'>

<img src='img/07/gg_layers.png' title='fig:'/>

<p><span class="small">
source: <a href='http://www.thinkr.fr/guide-survie-ggplot2-datajournalistes/' title=''>thinkR</a></span></p>

</div>

<p><span class="small">
<a href='http://www.tandfonline.com/doi/abs/10.1198/jcgs.2009.07098' title=''>Wickham H. 2007. <em>J. Comp. Graph. Stat.</em> <strong>19</strong>:3–28</a></span></p>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Simple example </h2><h3> Wickham 2007</h3></hgroup><article  id="simple-example-wickham-2007" class="smaller build">

<div class = 'box col col-6 stretch compact-table'><h3>dataset</h3><div class = 'box-body'>

<table class = 'rmdtable'>
<col width="8%" />
<col width="6%" />
<col width="9%" />
<tr class="header">
<th align="left">x</th>
<th align="left">y</th>
<th align="left">shape</th>
</tr>
<tr class="odd">
<td align="left">25</td>
<td align="left">11</td>
<td align="left">circle</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">circle</td>
</tr>
<tr class="odd">
<td align="left">75</td>
<td align="left">53</td>
<td align="left">square</td>
</tr>
<tr class="even">
<td align="left">200</td>
<td align="left">300</td>
<td align="left">square</td>
</tr>
</table>

</div></div><div class = 'box col col-6'><h3>3 layers combined</h3><div class = 'box-body'>

<ul>
<li><strong>aesthetics</strong>: <em>x</em> = x, <em>y</em> = y, <em>shape</em> = shape</li>
<li><strong>geometric</strong> object: dot / point</li>
</ul>

<img src='img/07/simple_plot.png' title='fig:'/>

</div></div><div class = 'box col col-8 offset-2 bg-grgold'><h3>Faceting (treillis / latticing)</h3><div class = 'box-body'>

<p>What is we want to split <em>circles</em> and <em>squares</em>?</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Faceting </h2><h3> Wickham 2007</h3></hgroup><article  id="faceting-wickham-2007" class="smaller vs1 build">

<div class = 'col col-8 offset-2'><h3>Split by the <strong>shape</strong></h3>

<img src='img/07/simple_facet.png' title='fig:'/>

</div>

<div class = 'box col col-8 offset-2 bg-grgold'><h3>Redundancy</h3><div class = 'box-body'>

<p>Now, <strong>dot shapes</strong> and <strong>facets</strong> give the same information. Shapes could be freed for another meaningful variable</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>layers</h2></hgroup><article  id="layers" class="smaller nvs1">

<div class = 'col col-8 offset-2'>

<img src='img/07/ggplot2_layers.png' title='fig:'/>

</div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>for real</h2></hgroup><article  id="for-real" class="smaller ">

<div id="unnamed-chunk-5" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>tribble(
  ~x,   ~y,    ~shape,
  25L,  11L,  &quot;circle&quot;,
  0L,   0L,  &quot;circle&quot;,
  75L,  53L,  &quot;square&quot;,
  200L, 300L,  &quot;square&quot;) %&gt;%
  ggplot(aes(x = x, y = y, shape = shape)) +
  geom_point(size = 4) +
  facet_wrap(~ shape) +
  coord_cartesian() +
  theme_classic(base_size = 18)</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-5-1.png' title=''/><!-- --></p></div></div>

<div class = 'box col col-8 bg-aquamarine2 offset-2'><h3>Tip</h3><div class = 'box-body'>

<p>awesome <a href='https://rstudio.github.io/rstudioaddins/' title=''>addin</a>: <a href='https://github.com/MilesMcBain/datapasta' title=''>datapasta</a>, paste as <em>tribbles</em> (transposed <em>tibbles</em>)</p>

<p>by Miles McBrain <img src='https://pbs.twimg.com/profile_images/702995114075955200/8s0ystej_bigger.jpg' title=''/></p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Motivation for this layered system </h2><h3> football example</h3></hgroup><article  id="motivation-for-this-layered-system-football-example" class="smaller vs1">

<blockquote class = "bg-grgold">
<p><em>Data visualisation</em> is not meant just to be seen but to be read, like written text <cite> Alberto Cairo </p></cite>
</blockquote>

<div id="unnamed-chunk-6">
</div>

<div id="unnamed-chunk-7" class="col col-12 box chunk bg-cobalt compact-output">
<h3>

Using the <a href='http://www.euroclubindex.com/asp/Methodology.asp' title=''>Euro Club Index</a> dataset

</h3>

<pre ># A tibble: 1,556 x 12
            club score  year country     n  rank allRank   atb   atw    eb
           &lt;chr&gt; &lt;int&gt; &lt;int&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1     ManUnited  1876  2001     ENG    20     1       6  2031  1831  1927
 2     Liverpool  1876  2001     ENG    20     2       5  2020  1826  1918
 3         Leeds  1843  2001     ENG    20     3      11  1979  1793  1880
 4       Arsenal  1820  2001     ENG    20     4      14  1946  1776  1868
 5       Chelsea  1794  2001     ENG    20     5      18  1860  1738  1865
 6       Ipswich  1744  2001     ENG    20     6      31  1830  1710  1840
 7    Sunderland  1732  2001     ENG    20     7      34  1802  1688  1813
 8    AstonVilla  1725  2001     ENG    20     8      42  1775  1667  1796
 9     Newcastle  1704  2001     ENG    20     9      46  1765  1663  1792
10 Middlesbrough  1699  2001     ENG    20    10      49  1737  1661  1791
# ... with 1,546 more rows, and 2 more variables: ew &lt;int&gt;, tenth &lt;int&gt;</pre></div>

<p><span class="small">
source <a href='http://johnburnmurdoch.github.io/slides/r-ggplot/' title=''>John Burn-Murdoch</a> working at the Financial Times</span></p>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>questions &amp; solutions</h2></hgroup><article  id="questions-solutions" class="smaller build vs1">

<div class = 'box col col-5 bg-yellow compact-output'><h3>Questions</h3><div class = 'box-body'>

<ol>
<li>which countries have the best teams?</li>
<li>which leagues are the most/least balanced?</li>
<li>what is the &#39;quality gap&#39; between a given pair of leagues?</li>
<li>how does the nth best team in league x today compare to its predecessors?</li>
<li>how have all of the above changed over time?</li>
</ol>

</div></div><div class = 'box col col-4 bg-green stretch'><h3>Stat solutions</h3><div class = 'box-body'>

<ol>
<li>linear comparison</li>
<li>distribution of parts within the whole</li>
<li>difference in area between two curves</li>
<li>value in context</li>
<li>evolution of an already detailed pattern over time</li>
</ol>

</div></div><div class = 'box col col-3 bg-grgold stretch'><h3>Visual solutions</h3><div class = 'box-body'>

<ol>
<li><p>points</p></li>
<li><p>points on a line</p></li>
<li><p>ribbon</p></li>
<li><p>shaded range</p></li>
<li><p>faceted plots</p></li>
</ol>

</div></div>

<p><span class="small">
source <a href='http://johnburnmurdoch.github.io/slides/r-ggplot/' title=''>John Burn-Murdoch</a> working at the Financial Times</span></p>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>1. which countries have the best teams in 2016?</h2></hgroup><article  id="which-countries-have-the-best-teams-in-2016" class="smaller build nvs1">

<div class = 'col col-12'>

<div id="unnamed-chunk-8" class="col col-12 box chunk bg-cobalt">
<div class="col col-8 r-source">
<pre class = 'prettyprint lang-r'>oneSeason %&gt;%
  ggplot(aes(x = year, y = score, colour = country)) + 
  geom_point(size = 3) +
  scale_x_discrete() +
  theme_bw(base_size = 18)</pre></div>

<div class="col col-4 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-8-1.png' title=''/><!-- --></p></div></div>

</div><div class = 'col col-12 bg-gray'><h3>comments</h3>

<ul>
<li><code>size = 3</code> increases the size of <em>all</em> dots. Not in <code>aes()</code></li>
<li><code>scale_x_discrete</code> is to force the 1 value on the x axis to be discrete</li>
<li><code>theme_bw()</code> is a pre-defined <em>black/white</em> theme, where all fonts are set to size = 18</li>
</ul>

</div><div class = 'offset-3 box col col-6 bg-red'><h3>Issue</h3><div class = 'box-body'>

<p>we can&#39;t see much: Improve the <strong>x</strong> mapping</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>1. which countries have the best teams in 2016? </h2><h3> with rank</h3></hgroup><article  id="which-countries-have-the-best-teams-in-2016-with-rank" class="smaller nvs1 build">

<div class = 'col col-12'>

<div id="unnamed-chunk-9" class="col col-12 box chunk bg-cobalt">
<div class="col col-5 r-source">
<pre class = 'prettyprint lang-r'>oneSeason %&gt;%
  ggplot(aes(x = rank, y = score,
             colour = country)) + 
  geom_point(size = 3) +
  theme_bw(18)</pre></div>

<div class="col col-7 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-9-1.png' title=''/><!-- --></p></div></div>

</div><div class = 'col col-8 bg-gray stretch'><h3>comments</h3>

<ul>
<li><code>scale_x_discrete</code> useless, <strong>continuous</strong> variable.</li>
<li>omit <code>base_size =</code> in <code>theme_bw()</code> (1st argument)</li>
</ul>

</div><div class = 'box col col-4 bg-grgold stretch'><h3>Spain</h3><div class = 'box-body'>

<p>Now obvious that Spain does well, even for low ranking clubs</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>2. which leagues are most/least balanced in 2016?</h2></hgroup><article  id="which-leagues-are-mostleast-balanced-in-2016" class="smaller nvs1 build">

<div class = 'col col-12'>

<div id="unnamed-chunk-10" class="col col-12 box chunk bg-cobalt">
<div class="col col-5 r-source">
<pre class = 'prettyprint lang-r'>oneSeason %&gt;%
  ggplot(aes(rank, score, 
             colour = country)) +
   geom_line() + 
   geom_point(size = 3) + 
   theme_bw(18)</pre></div>

<div class="col col-7 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-10-1.png' title=''/><!-- --></p></div></div>

</div><div class = 'col col-8 bg-gray stretch'><h3>comments</h3>

<ul>
<li><code>aes()</code> define in <code>ggplot()</code> are passed on <strong>all</strong> subsequent <code>geom</code></li>
<li><code>x</code> and <code>y</code> could be omitted, best to specify</li>
</ul>

</div><div class = 'box col col-4 bg-red'><h3>Issue</h3><div class = 'box-body'>

<p>Hard to see differences, ENG seems more coherent</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>2. which leagues are most/least balanced in 2016? </h2><h3> with range</h3></hgroup><article  id="which-leagues-are-mostleast-balanced-in-2016-with-range" class="smaller vs2 build">

<div class = 'col col-12'>

<div id="unnamed-chunk-11" class="col col-12 box chunk bg-cobalt">
<div class="col col-8 r-source">
<pre class = 'prettyprint lang-r'>oneSeason %&gt;%
  group_by(country) %&gt;%
  summarise(min = min(score),
            max = max(score),
            range = max - min) %&gt;%
  mutate(country = forcats::fct_reorder(country, range)) %&gt;%
  ggplot(aes(x = &quot;2016&quot;, y = range, fill = country)) +
  geom_col(position = &quot;dodge&quot;) +
  theme_classic(18)</pre></div>

<div class="col col-4 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-11-1.png' title=''/><!-- --></p></div></div>

</div><div class = 'box col col-4 bg-aquamarine2 stretch'><h3>Tip x-axis</h3><div class = 'box-body'>

<p>force the discretization using 2016 as character</p>

</div></div><div class = 'box col col-4 bg-aquamarine2 stretch'><h3>Tip fill</h3><div class = 'box-body'>

<p>use dodging to get all bars on the same x index</p>

</div></div><div class = 'box col col-4 bg-aquamarine2'><h3>Tip fill order</h3><div class = 'box-body'>

<p>reorder levels based on a numeric variable using <code>fct_reorder</code></p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>3. <em>Quality gap</em> between England and Spain in 2016? </h2><h3> score diff at each rank</h3></hgroup><article  id="quality-gap-between-england-and-spain-in-2016-score-diff-at-each-rank" class="smaller vs1 build">

<div class = 'col col-12'>

<div id="unnamed-chunk-12" class="col col-12 box chunk bg-cobalt">
<div class="col col-7 r-source">
<pre class = 'prettyprint lang-r'>oneSeason %&gt;%
  select(score, rank, country) %&gt;%
  filter(country %in% c(&quot;ENG&quot;, &quot;ESP&quot;)) %&gt;%
  spread(country, score) %&gt;%
  rowwise() %&gt;%
  mutate(gap = ESP - ENG,
         min = min(ESP, ENG),
         max = max(ESP, ENG)) %&gt;%
  ggplot(aes(x = rank, fill = gap &gt; 0)) + 
  geom_rect(aes(xmin = rank - 0.5, 
                xmax = rank + 0.5, 
                ymin = min, ymax = max), alpha = 0.8) + 
  theme_classic(18) +
  scale_fill_manual(name = &quot;gap&quot;, labels = c(&quot;ENG&quot;, &quot;ESP&quot;), 
                    values = c(&quot;royalblue&quot;, &quot;red3&quot;)) +
  labs(title = &quot;quality gap&quot;,
       subtitle = &quot;between England and Spain&quot;,
       caption = &quot;by John Burn-Murdoch&quot;)</pre></div>

<div class="col col-5 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-12-1.png' title=''/><!-- --></p></div></div>

</div><div class = 'col col-8 bg-gray stretch'><h3>comments</h3>

<ul>
<li>spread so diff is easy to compute between column</li>
<li><code>rowwise()</code> mandatory to get the right min and max</li>
</ul>

</div><div class = 'box col col-4 bg-grgold'><h3>Spain clubs</h3><div class = 'box-body'>

<p>are performing better at every rank except #11</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>4.How does the <em>nth</em> best English team in 2016 compare to its predecessors?</h2></hgroup><article  id="how-does-the-nth-best-english-team-in-2016-compare-to-its-predecessors" class="smaller build vs2">

<div class = 'col col-12'>

<div id="unnamed-chunk-13" class="col col-12 box chunk bg-cobalt">
<div class="col col-7 r-source">
<pre class = 'prettyprint lang-r'>oneSeason %&gt;%
  filter(country == &quot;ENG&quot;) %&gt;%
  ggplot(aes(x = rank, y = score)) + 
  geom_ribbon(aes(ymin = atw, ymax = atb),
              fill = &quot;royalblue&quot;, alpha = 0.5) + 
  geom_line(size = 1.5, colour = &quot;royalblue&quot;) + 
  geom_point(size = 3, colour = &quot;royalblue&quot;) + 
  theme_bw(18) + 
  scale_fill_manual(name = &quot;gap&quot;, labels = c(&quot;ENG&quot;, &quot;ESP&quot;), 
                    values = c(&quot;royalblue&quot;, &quot;red3&quot;)) +
  labs(title = &quot;Comparison of the nth best \nteam to its predecessors&quot;,
       subtitle = &quot;in England in 2016&quot;,
       caption = &quot;by John Burn-Murdoch&quot;)</pre></div>

<div class="col col-5 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-13-1.png' title=''/><!-- --></p></div></div>

</div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>5. How to visualise over time? </h2><h3> facet: best country</h3></hgroup><article  id="how-to-visualise-over-time-facet-best-country" class="smaller nvs1 build">

<div class = 'col col-12'>

<div id="unnamed-chunk-14" class="col col-12 box chunk bg-cobalt">
<div class="col col-4 r-source">
<pre class = 'prettyprint lang-r'>allSeasons %&gt;%
  ggplot(aes(rank, score, 
             colour = country)) +
  geom_line() + 
  #geom_point(size = 1.5) + 
  theme_classic(18) +
  facet_wrap(~ year)</pre></div>

<div class="col col-8 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-14-1.png' title=''/><!-- --></p></div></div>

</div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>5. How to visualise over time? </h2><h3> facet</h3></hgroup><article  id="how-to-visualise-over-time-facet" class="smaller build">

<div class = 'col col-12'>

<div id="unnamed-chunk-15" class="col col-12 box chunk bg-cobalt">
<h3>

gap code

</h3>

<pre class = 'prettyprint lang-r'>allSeasons %&gt;%
  select(score, year, rank, country) %&gt;%
  filter(country %in% c(&quot;ENG&quot;, &quot;ESP&quot;)) %&gt;%
  spread(country, score) %&gt;%
  rowwise() %&gt;%
  mutate(gap = ESP - ENG,
         min = min(ESP, ENG),
         max = max(ESP, ENG)) %&gt;%
  ggplot(aes(x = rank, fill = gap &gt; 0)) + 
  geom_rect(aes(xmin = rank - 0.5, 
                xmax = rank + 0.5, 
                ymin = min, ymax = max), alpha = 0.8) + 
  theme_classic(18) +
  scale_fill_manual(name = &quot;gap&quot;, labels = c(&quot;ENG&quot;, &quot;ESP&quot;), 
                    values = c(&quot;royalblue&quot;, &quot;red3&quot;)) +
  labs(title = &quot;quality gap&quot;,
       subtitle = &quot;between England and Spain&quot;,
       caption = &quot;by John Burn-Murdoch&quot;) +
  facet_wrap(~ year)</pre></div>

</div><div class = 'box col col-8 offset-2 bg-grgold'><h3>thanks to tidy data</h3><div class = 'box-body'>

<p>only add the <code>facet</code> layer to split into panels</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>5. How to visualise over time? </h2><h3> facet: gap plot</h3></hgroup><article  id="how-to-visualise-over-time-facet-gap-plot" class="smaller ">

<div id="unnamed-chunk-16">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-16-1.png' title=''/><!-- --></p></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>your turn</h2></hgroup><article  id="your-turn" class="smaller ">

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>iris dataset </h2><h3> rstudio <a href='https://www.rstudio.org/links/data_visualization_cheat_sheet' title=''>cheatsheet</a></h3></hgroup><article  id="iris-dataset-rstudio-cheatsheet" class="smaller vs1">

<div id="unnamed-chunk-17" class="col col-12 box chunk bg-cobalt compact-output">
<h3>

save as <code>tibble</code> the long <code>data.frame</code>

</h3>

<pre class = 'prettyprint lang-r'>iris &lt;- as_tibble(iris)
iris</pre>

<pre ># A tibble: 150 x 5
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;  &lt;fctr&gt;
 1          5.1         3.5          1.4         0.2  setosa
 2          4.9         3.0          1.4         0.2  setosa
 3          4.7         3.2          1.3         0.2  setosa
 4          4.6         3.1          1.5         0.2  setosa
 5          5.0         3.6          1.4         0.2  setosa
 6          5.4         3.9          1.7         0.4  setosa
 7          4.6         3.4          1.4         0.3  setosa
 8          5.0         3.4          1.5         0.2  setosa
 9          4.4         2.9          1.4         0.2  setosa
10          4.9         3.1          1.5         0.1  setosa
# ... with 140 more rows</pre></div>

<div class = 'box col col-6 bg-grgold stretch'><h3>smart printing of the iris dataset</h3><div class = 'box-body'>

<p>as a <code>tibble</code> to avoid printing all 150 rows</p>

</div></div><div class = 'box col col-6 bg-aquamarine2'><h3>change default theme</h3><div class = 'box-body'>

<p>I set for this course the following to avoid the grey background and print bigger text</p>

<div id="unnamed-chunk-18" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot2::theme_set(ggplot2::theme_bw(18))</pre></div>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Draw your first plot</h2></hgroup><article  id="draw-your-first-plot" class="smaller ">

<div id="unnamed-chunk-19" class="col col-12 box chunk bg-cobalt">
<h3>

Petal: Length versus Width

</h3>

<pre class = 'prettyprint lang-r'>iris %&gt;%
  ggplot() +
  geom_point(aes(x = Petal.Width, y = Petal.Length))</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-19-1.png' title=''/><!-- --></p></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>geometric objects </h2><h3> geoms define the type of plot which will be drawn</h3></hgroup><article  id="geometric-objects-geoms-define-the-type-of-plot-which-will-be-drawn" class="smaller build nvs1">

<div class = 'box col col-4 bg-cobalt'><h3><code>geom_point()</code></h3><div class = 'box-body'>

<div id="unnamed-chunk-20">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-20-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-4 bg-cobalt'><h3><code>geom_line()</code></h3><div class = 'box-body'>

<div id="unnamed-chunk-21">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-21-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-4 bg-cobalt'><h3><code>geom_bar()</code></h3><div class = 'box-body'>

<div id="unnamed-chunk-22">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-22-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-4 bg-cobalt'><h3><code>geom_boxplot()</code></h3><div class = 'box-body'>

<div id="unnamed-chunk-23">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-23-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-4 bg-cobalt'><h3><code>geom_histogram()</code></h3><div class = 'box-body'>

<div id="unnamed-chunk-24">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-24-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-4 bg-cobalt'><h3><code>geom_density()</code></h3><div class = 'box-body'>

<div id="unnamed-chunk-25">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-25-1.png' title=''/><!-- --></p></div>

<ul>
<li>Have a look at the <a href='https://www.rstudio.org/links/data_visualization_cheat_sheet' title=''>cheatsheet</a> or the ggplot2 online <a href='http://ggplot2.tidyverse.org/' title=''>documentation</a> to list more possibilities.</li>
</ul>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Mapping aesthetics</h2></hgroup><article  id="mapping-aesthetics" class="smaller vs2">

<div class = 'box col col-12 bg-gray'><h3>definitions</h3><div class = 'box-body'>

<ul>
<li><strong>aesthetics</strong> map the columns of a <code>data.frame</code>/<code>tibble</code> to the variable each ggplot2 <code>geom</code> is expecting.</li>
<li>example <code>geom_point()</code> requires <strong>at least</strong> the <em><strong>x</strong></em> and <em><strong>y</strong></em> coordinates for each point.</li>
</ul>

</div></div>

<div id="unnamed-chunk-26" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_point(aes(x = Petal.Width, y = Petal.Length))</pre></div>

<div id="unnamed-chunk-27" class="compact-table">
<table class = 'rmdtable'>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
</table></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Unmapped paramaters</h2></hgroup><article  id="unmapped-paramaters" class="smaller ">

<p>Additional arguments such as the <code>colour</code>, the transparency (<code>alpha</code>) or the <code>size</code>.</p>

<div class = 'col col-6'>

<div id="unnamed-chunk-28" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_point(aes(x = Petal.Width,
                 y = Petal.Length),
             colour = &quot;blue&quot;, alpha = 0.6, 
             size = 3)</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-28-1.png' title=''/><!-- --></p></div>

</div><div class = 'box col col-6 bg-red'><h3>important</h3><div class = 'box-body'>

<p>see that paramaters define <strong>outside</strong> the aesthetics <code>aes()</code> are applied to <strong>all</strong> data</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Mapping aesthetics </h2><h3> colour</h3></hgroup><article  id="mapping-aesthetics-colour" class="smaller ">

<p><code>colour</code>, <code>alpha</code> or <code>size</code> can also be mapped to a column in the data frame.</p>

<p>For example: We can attribute a different color to each species:</p>

<div class = 'col col-6'>

<div id="unnamed-chunk-29" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_point(aes(x = Petal.Width,
                 y = Petal.Length,
                 colour = Species),
             alpha = 0.6, size = 3)</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-29-1.png' title=''/><!-- --></p></div>

</div><div class = 'box col col-6 bg-red'><h3>important</h3><div class = 'box-body'>

<p>Note that the <code>colour</code> argument now is <strong>inside</strong> <code>aes()</code> and <strong>must</strong> refer to a column in the dataframe.</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Mapping aesthetics </h2><h3> shape</h3></hgroup><article  id="mapping-aesthetics-shape" class="smaller vs1">

<div id="unnamed-chunk-30" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_point(aes(x = Petal.Width, y = Petal.Length, shape = Species, colour = Species),
             alpha = 0.6, size = 3)</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-30-1.png' title=''/><!-- --></p></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Mapping aesthetics </h2><h3> group</h3></hgroup><article  id="mapping-aesthetics-group" class="smaller build">

<div class = 'box col col-6 bg-red stretch'><h3>problem, toy data</h3><div class = 'box-body'>

<div id="unnamed-chunk-31" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'># sample data
set.seed(12)
d &lt;- data.frame(expand.grid(x = letters[1:4],
                        g = factor(1:2)),
                        y = rnorm(8))
d</pre>

<pre >  x g          y
1 a 1 -1.4805676
2 b 1  1.5771695
3 c 1 -0.9567445
4 d 1 -0.9200052
5 a 2 -1.9976421
6 b 2 -0.2722960
7 c 2 -0.3153487
8 d 2 -0.6282552</pre></div>

</div></div><div class = 'box col col-6 bg-red stretch'><h3>problem, plot data</h3><div class = 'box-body'>

<div id="unnamed-chunk-32" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(d, aes(x, y, colour = g)) +
  geom_line() + 
  geom_point()</pre>

<pre >geom_path: Each group consists of only one observation. Do you need to
adjust the group aesthetic?</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-32-1.png' title=''/><!-- --></p></div>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Mapping aesthetics </h2><h3> group</h3></hgroup><article  id="mapping-aesthetics-group-1" class="smaller build">

<div class = 'box col col-6 bg-grgold stretch'><h3>solution: grouping</h3><div class = 'box-body'>

<div id="unnamed-chunk-33" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(d, aes(x, y, colour = g, group = g)) +
  geom_line() +
  geom_point()</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-33-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-6 bg-blue stretch'><h3>force grouping</h3><div class = 'box-body'>

<div id="unnamed-chunk-34" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(d, aes(x, y, colour = g, group = 1)) +
  geom_line() +
  geom_point()</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-34-1.png' title=''/><!-- --></p></div>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Labels</h2></hgroup><article  id="labels" class="smaller vs2">

<p>It is easy to adjust axis labels and the title</p>

<div id="unnamed-chunk-35" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_point(aes(x = Petal.Width,
                 y = Petal.Length,
                 colour = Species), 
             alpha = 0.6, size = 3) +
  labs(x = &quot;Width&quot;,
       y = &quot;Length&quot;,
       colour = &quot;flower&quot;,
       title = &quot;Iris&quot;,
       subtitle = &quot;petal measures&quot;,
       caption = &quot;Fisher, R. A. (1936)&quot;)</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-35-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Histograms</h2></hgroup><article  id="histograms" class="smaller ">

<div id="unnamed-chunk-36" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_histogram(aes(x = Petal.Length,
                     fill = Species),
                 alpha = 0.8,
                 bins = 30)</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-36-1.png' title=''/><!-- --></p>

<pre class = 'prettyprint lang-r'># default #&#39; bin is 30
# to avoid warnings</pre></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Density plot</h2></hgroup><article  id="density-plot" class="smaller ">

<p>The density is the count divided by the total number of occurences.</p>

<div id="unnamed-chunk-37" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_density(aes(x = Petal.Length,
                   fill = Species),
               alpha = 0.6)</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-37-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Overlaying plots </h2><h3> Density plot and histogram</h3></hgroup><article  id="overlaying-plots-density-plot-and-histogram" class="smaller ">

<div id="unnamed-chunk-38" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_histogram(aes(x = Petal.Length, y = ..density..), fill = &quot;darkgrey&quot;, binwidth = 0.1) +
  geom_density(aes(x = Petal.Length, fill = Species, colour = Species), alpha = 0.4) +
  theme_classic()</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-38-1.png' title=''/><!-- --></p></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Stat functions</h2></hgroup><article  id="stat-functions" class="smaller nvs1 build">

<div class = 'bg-aquamarine2 box col col-12 icon'><h3>transform data</h3><div class = 'box-body'>

<img src='img/07/stats.png' title='fig:'/>

<ul>
<li>variables surrounded by two pair of dots (<code>..variable..</code>) are intermediate values calculated by <code>ggplot2</code> using stat functions</li>
<li><code>geom</code> uses a <code>stat</code> function to transform the data:

<ul>
<li><code>geom_histogram()</code> uses <code>stat_bin()</code> to divide the data into <em>bins</em> and count the number of observations in each <em>bin</em>.</li>
<li><code>stat_bin()</code> computes for example: <code>..count..</code>, <code>..density..</code>, <code>..ncount..</code> and <code>..ndensity..</code> (see <code>?stat_bin()</code>)</li>
<li>stat variable for density plot: <code>..density..</code></li>
<li><code>stat_identity</code> is used for scatter plots or <code>geom_col()</code>, no transformation</li>
</ul></li>
</ul>

</div></div><div class = 'box col col-4 bg-yellow'><h3>1D</h3><div class = 'box-body'>

<ul>
<li><code>stat_count</code></li>
<li><code>stat_bin</code></li>
</ul>

</div></div><div class = 'box col col-4 bg-yellow'><h3>2D</h3><div class = 'box-body'>

<ul>
<li><code>stat_density_2d</code></li>
<li><code>stat_bin_2d</code></li>
<li><code>stat_ellipse</code></li>
</ul>

</div></div><div class = 'box col col-4 bg-yellow'><h3>3D</h3><div class = 'box-body'>

<ul>
<li><code>stat_contour</code></li>
<li><code>stat_summary_hex</code></li>
</ul>

<p><span class="small">
source: ggplot2 cheatsheet by Rstudio</span></p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Barcharts </h2><h3> categorical variables</h3></hgroup><article  id="barcharts-categorical-variables" class="smaller ">

<div class = 'box col col-12 bg-gray'><h3>definitions</h3><div class = 'box-body'>

<ul>
<li>By default, <code>geom_bar()</code> counts the number of occurences for each values of a categorical variable.</li>
<li><code>geom_bar()</code> uses <code>stat_count()</code> to compute these values (creating a new <code>count</code> column)</li>
</ul>

<div id="unnamed-chunk-39" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_bar(aes(x = Species))</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-39-1.png' title=''/><!-- --></p>

<pre class = 'prettyprint lang-r'># or: geom_bar(aes(x = Species, y = ..count..))</pre></div>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Barcharts </h2><h3> categorical variables</h3></hgroup><article  id="barcharts-categorical-variables-1" class="smaller vs1 build">

<div class = 'box col col-12 bg-gray'><h3>map a continous variable on <code>y</code> axis</h3><div class = 'box-body'>

<ul>
<li>we need to override the default call to <code>stat_count()</code></li>
<li><code>stat = &quot;identity&quot;</code> will force <code>geom_bar()</code> to use <code>stat_identity()</code> instead</li>
</ul>

<div id="unnamed-chunk-40" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_bar(aes(x = Species, y = Petal.Length),
           stat = &quot;identity&quot;)</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-40-1.png' title=''/><!-- --></p></div></div>

</div></div><div class = 'box col col-6 bg-grgold'><h3>Update v2.1</h3><div class = 'box-body'>

<p>since version 2.1, thanks to Bob Rudis, <code>geom_col()</code> does require a <strong>y</strong> variable</p>

</div></div><div class = 'box col col-6 bg-cobalt stretch'><h3><code>geom_col</code></h3><div class = 'box-body'>

<div id="unnamed-chunk-41" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(iris) +
  geom_col(aes(x = Species, y = Petal.Length))</pre></div>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Stacked barchart </h2><h3> categorical variables</h3></hgroup><article  id="stacked-barchart-categorical-variables" class="smaller ">

<div id="unnamed-chunk-42" class="col col-12 box chunk bg-cobalt">
<h3>

force factor to convert continuous -&gt; discrete

</h3>

<pre class = 'prettyprint lang-r'>mtcars %&gt;%
  ggplot() +
  geom_bar(aes(x = factor(cyl),
               fill = factor(gear)))</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-42-1.png' title=''/><!-- --></p></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Dodged barchart (side by side) </h2><h3> categorical variables</h3></hgroup><article  id="dodged-barchart-side-by-side-categorical-variables" class="smaller build">

<div id="unnamed-chunk-43" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>mtcars %&gt;%
  mutate(cyl = factor(cyl),
         gear = factor(gear)) %&gt;%
  complete(cyl, gear) %&gt;%
  ggplot() +
  geom_bar(aes(x = cyl, 
               fill = gear),
           position = &quot;dodge&quot;)</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-43-1.png' title=''/><!-- --></p></div></div>

<div class = 'box col col-8 bg-grgold offset-2'><h3>Complete</h3><div class = 'box-body'>

<p>the combination <code>gear</code> 4 / <code>cyl</code> 8 is missing. Using <code>tidyr::complete()</code> to avoid bars with different widths.</p>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Stacked barchart for proportions </h2><h3> categorical variables</h3></hgroup><article  id="stacked-barchart-for-proportions-categorical-variables" class="smaller ">

<div id="unnamed-chunk-44" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>mtcars %&gt;%
  mutate(cyl = factor(cyl),
         gear = factor(gear)) %&gt;%
  complete(cyl, gear) %&gt;%
  ggplot() +
  geom_bar(aes(x = cyl, 
               fill = gear),
           position = &quot;fill&quot;)</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-44-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Stacked barchart for proportions </h2><h3> pie charts</h3></hgroup><article  id="stacked-barchart-for-proportions-pie-charts" class="smaller ">

<p>We can easily switch to polar coordinates:</p>

<div id="unnamed-chunk-45" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>mtcars %&gt;%
  mutate(cyl = factor(cyl),
         gear = factor(gear)) %&gt;%
  complete(cyl, gear) %&gt;%
  ggplot() +
  geom_bar(aes(x = cyl, 
               fill = gear),
           position = &quot;fill&quot;) +
  coord_polar()</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-45-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Boxplot </h2><h3> IQR, median</h3></hgroup><article  id="boxplot-iqr-median" class="smaller vs1">

<div id="unnamed-chunk-46" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_boxplot(aes(x = factor(cyl),
                   y = mpg))</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-46-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Boxplot </h2><h3> dodge by default</h3></hgroup><article  id="boxplot-dodge-by-default" class="smaller vs1">

<div id="unnamed-chunk-47" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_boxplot(aes(x = factor(cyl),
                   y = mpg,
                   fill = factor(am)))</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-47-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Boxplots are unreliable </h2><h3> n = 2!</h3></hgroup><article  id="boxplots-are-unreliable-n-2" class="smaller ">

<div id="unnamed-chunk-48" class="col col-12 box chunk bg-cobalt">
<h3>

ggbeeswarm

</h3>

<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  ggbeeswarm::geom_quasirandom(aes(x = factor(cyl),
                   y = mpg,
                   colour = factor(am)))</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-48-1.png' title=''/><!-- --></p></div></div>

<div id="unnamed-chunk-49" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>ggplot(iris, aes(x = Species, y = Petal.Length)) +
  geom_violin() +
  ggbeeswarm::geom_quasirandom()</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-49-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Custom colors</h2></hgroup><article  id="custom-colors" class="smaller nvs1">

<div class = 'box col col-12 bg-gray'><h3>manual entry</h3><div class = 'box-body'>

<ul>
<li>using <code>scale_fill_manual()</code> and <code>scale_color_manual()</code></li>
<li>not handy as you <strong>must</strong> provide as much colours as groups</li>
</ul>

<div id="unnamed-chunk-50" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_boxplot(aes(x = factor(cyl), y = mpg,
                   fill = factor(am), color = factor(am))) +
  scale_fill_manual(values = c(&quot;red&quot;, &quot;lightblue&quot;)) +
  scale_color_manual(values = c(&quot;purple&quot;, &quot;blue&quot;))</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-50-1.png' title=''/><!-- --></p></div>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Predefined color palettes</h2></hgroup><article  id="predefined-color-palettes" class="smaller ">

<div id="unnamed-chunk-51" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>library(RColorBrewer)
display.brewer.all()</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-51-1.png' title=''/><!-- --></p></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Custom colors </h2><h3> using brewer</h3></hgroup><article  id="custom-colors-using-brewer" class="smaller ">

<div id="unnamed-chunk-52" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_boxplot(aes(x = factor(cyl), y = mpg,
                   fill = factor(am), colour = factor(am))) +
  scale_fill_brewer(palette = &quot;Pastel2&quot;) +
  scale_colour_brewer(palette = &quot;Set1&quot;)</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-52-1.png' title=''/><!-- --></p></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>colour gradient </h2><h3> ggplot2 default is ugly</h3></hgroup><article  id="colour-gradient-ggplot2-default-is-ugly" class="smaller build">

<div class = 'bg-blue box col col-6'><h3>default</h3><div class = 'box-body'>

<div id="unnamed-chunk-53" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>mtcars %&gt;%
  ggplot(aes(x = wt,
             y = mpg,
             colour = hp)) +
  geom_point(size = 3)</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-53-1.png' title=''/><!-- --></p></div></div>

</div></div><div class = 'bg-grgold box col col-6'><h3>viridis</h3><div class = 'box-body'>

<div id="unnamed-chunk-54" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>mtcars %&gt;%
  ggplot(aes(x = wt,
             y = mpg,
             colour = hp)) +
  geom_point(size = 3) +
  viridis::scale_colour_viridis()</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-54-1.png' title=''/><!-- --></p></div></div>

</div></div><div class = 'box col col-12 bg-pink2 icon'><h3>viridis</h3><div class = 'box-body'>

<img src='img/07/viridis_palette.png' title='fig:'/>

<ul>
<li>4 different scales</li>
<li><a href='https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html' title=''>viridis</a> is color blind friendly and nice in b&amp;w</li>
<li>default in <code>ggplot2</code> dev version</li>
</ul>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>aesthetic trick</h2></hgroup><article  id="aesthetic-trick" class="smaller ">

<div class = 'box col col-12 bg-aquamarine2'><h3>using strings</h3><div class = 'box-body'>

<ul>
<li>use a plain character inside <code>aes()</code></li>
<li>goes into the legend.</li>
<li>only for few layers when lazy enough to create the variable in the dataframe.</li>
</ul>

<div id="unnamed-chunk-55" class="col col-12 box chunk bg-cobalt">
<div class="col col-6 r-source">
<pre class = 'prettyprint lang-r'>set.seed(123)
dens &lt;- tibble(x = c(rnorm(500), 
                     rnorm(200, 3, 3)))
ggplot(dens) +
  geom_line(aes(x), stat = &quot;density&quot;) +
  geom_vline(aes(xintercept = mean(x),
                 colour = &quot;mean&quot;),
             size = 1.1) +
  geom_vline(aes(xintercept = median(x),
                 colour = &quot;median&quot;),
             size = 1.1) -&gt; p
p</pre></div>

<div class="col col-6 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-55-1.png' title=''/><!-- --></p></div></div>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>the data argument </h2><h3> each layer can get its own</h3></hgroup><article  id="the-data-argument-each-layer-can-get-its-own" class="smaller ">

<div id="unnamed-chunk-56" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>dens_mode &lt;- tibble(mode = density(dens$x)$x[which.max(density(dens$x)$y)])
p + geom_vline(data = dens_mode,
               aes(xintercept = mode, colour = &quot;mode&quot;), size = 1.1) +
  theme(legend.position = &quot;top&quot;) +
  scale_colour_hue(name = NULL) # could be: labs(colour = NULL)</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-56-1.png' title=''/><!-- --></p></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Facets </h2><h3> facet_wrap()</h3></hgroup><article  id="facets-facet_wrap" class="smaller ">

<div id="unnamed-chunk-57" class="col col-12 box chunk bg-cobalt">
<h3>

easiest way to create facet with a column name

</h3>

<div class="col col-5 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_point(aes(x = wt, y = mpg)) +
  facet_wrap(~ cyl)</pre></div>

<div class="col col-7 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-57-1.png' title=''/><!-- --></p></div></div>

<div id="unnamed-chunk-58" class="col col-12 box chunk bg-cobalt">
<div class="col col-5 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_point(aes(x = wt, y = mpg)) +
  facet_wrap(~ cyl, ncol = 2)</pre></div>

<div class="col col-7 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-58-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Facets </h2><h3> free scales</h3></hgroup><article  id="facets-free-scales" class="smaller ">

<div id="unnamed-chunk-59" class="col col-12 box chunk bg-cobalt">
<div class="col col-5 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_point(aes(x = wt, y = mpg)) +
  facet_wrap(~ cyl, scales = &quot;free_x&quot;)</pre></div>

<div class="col col-7 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-59-1.png' title=''/><!-- --></p></div></div>

<div id="unnamed-chunk-60" class="col col-12 box chunk bg-cobalt">
<div class="col col-5 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_point(aes(x = wt, y = mpg)) +
  facet_wrap(~ cyl, scales = &quot;free&quot;)</pre></div>

<div class="col col-7 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-60-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Facets </h2><h3> <code>facet_grid()</code> to lay out panels in a grid</h3></hgroup><article  id="facets-facet_grid-to-lay-out-panels-in-a-grid" class="smaller ">

<div class = 'box col col-6 bg-grgold'><h3>Specify a <strong>formula</strong></h3><div class = 'box-body'>

<p>the rows on the left and columns on the right separated by a tilde <code>~</code> (<em>i.e</em> <strong>by</strong>)</p>

</div></div>

<div id="unnamed-chunk-61" class="col col-12 box chunk bg-cobalt">
<div class="col col-4 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_point(aes(x = wt, y = mpg)) +
  facet_grid(am ~ cyl)</pre></div>

<div class="col col-8 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-61-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Facets </h2><h3> <code>facet_grid()</code> cont.</h3></hgroup><article  id="facets-facet_grid-cont." class="smaller ">

<div class = 'box col col-6 bg-grgold'><h3>Specify one row/column</h3><div class = 'box-body'>

<p>A dot (<code>.</code>) means no faceting for this axis. Mimic <code>facet_wrap()</code></p>

</div></div>

<div id="unnamed-chunk-62" class="col col-12 box chunk bg-cobalt">
<div class="col col-4 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_point(aes(x = wt, y = mpg)) +
  facet_grid(. ~ cyl)</pre></div>

<div class="col col-8 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-62-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Facets </h2><h3> labeller</h3></hgroup><article  id="facets-labeller" class="smaller vs1">

<p>Add the column names with <code>labeller</code></p>

<div id="unnamed-chunk-63" class="col col-12 box chunk bg-cobalt">
<div class="col col-5 r-source">
<pre class = 'prettyprint lang-r'>ggplot(mtcars) +
  geom_point(aes(x = wt, y = mpg)) +
  facet_grid(am ~ cyl,
             labeller = label_both)</pre></div>

<div class="col col-7 r-output">
<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-63-1.png' title=''/><!-- --></p></div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Exporting </h2><h3> interactive or passive mode</h3></hgroup><article  id="exporting-interactive-or-passive-mode" class="smaller nvs1 build">

<div class = 'box col col-6 bg-grgold'><h3>right panel</h3><div class = 'box-body'>

<ul>
<li>Using the Export button in the <em>Plots</em> panel</li>
</ul>

</div></div><div class = 'col col-6'>

<img src='img/07/export_plot.png' title='fig:'/>

</div><div class = 'box col col-6 bg-grgold'><h3>Rmarkdown reports</h3><div class = 'box-body'>

<ul>
<li>If needed, adjust the chunk options:</li>
<li>size: <code>fig.height</code>, <code>fig.width</code></li>
<li>ratio: <code>fig.asp</code>&#8230;</li>
<li><a href='https://yihui.name/knitr/options/?version=1.1.214&amp;mode=desktop' title=''>others</a></li>
</ul>

</div></div><div class = 'col col-6'>

<img src='img/07/chunk_options.png' title='fig:'/>

</div><div class = 'box col col-6 bg-grgold'><h3>ggsave</h3><div class = 'box-body'>

<ul>
<li>save the <code>ggplot</code> object, 2nd argument</li>
<li>guess the type of graphics by the extension</li>
</ul>

<div id="unnamed-chunk-64" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>ggsave(&quot;aes_trick.png&quot;, p,
       width = 60, height = 30, units = &quot;mm&quot;)
ggsave(&quot;aes_trick.pdf&quot;, p,
       width = 50, height = 50, units = &quot;mm&quot;)</pre></div>

</div></div><div class = 'col col-6'>

<img src='img/07/aes_trick.png' title='fig:'/>

</div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Extensions</h2></hgroup><article  id="extensions" class="smaller ">

<p><code>ggplot2</code> introduced the possibility for the community to contribute and <a href='http://ggplot2.tidyverse.org/articles/extending-ggplot2.html' title=''>create <strong>extensions</strong></a>.</p>

<p>They are referenced on a <a href='https://www.ggplot2-exts.org/' title=''>dedicated site</a></p>

<img src='img/07/extensions.png' title='fig:'/>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>plot your data! </h2><h3> <a href='https://d2f99xq7vri1nk.cloudfront.net/Anscombe_1_0_0.png' title=''>Anscombe</a> ** 10</h3></hgroup><article  id="plot-your-data-anscombe-10" class="smaller vs2">

<blockquote class = "bg-grgold">
<p>never trust summary statistics alone; always visualize your data <cite> Alberto Cairo </p></cite>
</blockquote>

<img src='https://d2f99xq7vri1nk.cloudfront.net/DinoSequentialSmaller.gif' title='fig:'/>

<p><span class="small">
source: Justin Matejka, George Fitzmaurice <a href='https://www.autodeskresearch.com/publications/samestats' title=''>Same Stats, Different Graphs&#8230;</a></span></p>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Art </h2><h3> by Marcus Volz</h3></hgroup><article  id="art-by-marcus-volz" class="smaller ">

<blockquote class="twitter-tweet">

<p lang="en" dir="ltr">

A compilation of some of my gifs created with <a href="https://twitter.com/hashtag/rstats?src=hash">#rstats</a> <a href="https://twitter.com/hashtag/ggplot2?src=hash">#ggplot2</a> <a href="https://twitter.com/hashtag/gganimate?src=hash">#gganimate</a> <a href="https://twitter.com/hashtag/tweenr?src=hash">#tweenr</a> <a href="https://t.co/nCppSOZv4W">https://t.co/nCppSOZv4W</a>

</p>

— Marcus Volz (<span class="cite">@mgvolz</span>) <a href="https://twitter.com/mgvolz/status/849375922297991168">4 avril 2017</a>

</blockquote>

<div id="unnamed-chunk-65">
<style type="text/css">
.vembedr {
  border-radius: 25px; /* adjust it to your needs */
  overflow: hidden;
}

.vembedr iframe {
  display: block;
  border: none;
}
</style></div>

<div id="unnamed-chunk-66">
<div class="vembedr">
<iframe src="https://www.youtube.com/embed/DQiKHlpy70Q" width="420" height="315" frameborder="0" allowfullscreen=""></iframe>
</div></div>

</article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>Missing features</h2></hgroup><article  id="missing-features" class="smaller nvs1 build">

<div class = 'box col col-6 bg-yellow'><h3>geoms list <a href='http://ggplot2.tidyverse.org/reference/index.html#section-layer-geoms' title=''>here</a></h3><div class = 'box-body'>

<ul>
<li><code>geom_tile()</code> heatmap</li>
<li><code>geom_bind2d()</code> 2D binning</li>
<li><code>geom_abline()</code> slope</li>
</ul>

</div></div><div class = 'box col col-6 bg-yellow stretch'><h3>stats list <a href='http://ggplot2.tidyverse.org/reference/index.html#section-layer-stats' title=''>here</a></h3><div class = 'box-body'>

<ul>
<li><code>stat_ellipse()</code></li>
<li><code>stat_summary()</code> easy mean 95CI etc.</li>
<li><code>geom_smooth()</code> linear/splines/non linear</li>
</ul>

</div></div><div class = 'box col col-6 bg-grgold stretch'><h3>plot on multi-pages</h3><div class = 'box-body'>

<ul>
<li><code>ggforce::facet_grid_paginate()</code> facets</li>
<li><code>gridExtra::marrangeGrob()</code> plots</li>
</ul>

</div></div><div class = 'box col col-6 bg-grgold stretch'><h3>positions list <a href='http://ggplot2.tidyverse.org/reference/index.html#section-layer-position-adjustment' title=''>here</a></h3><div class = 'box-body'>

<ul>
<li><code>position_jitter()</code> random shift</li>
<li><code>quasirandom()</code> is better</li>
</ul>

</div></div><div class = 'box col col-6 bg-blue stretch'><h3>coordinate / transform</h3><div class = 'box-body'>

<ul>
<li><code>coord_cartesian()</code> for zooming in</li>
<li><code>coord_flip()</code> exchanges <em>x</em> &amp; <em>y</em></li>
<li><code>scale_x_log10()</code> and <em>y</em></li>
<li><code>scale_x_sqrt()</code> and <em>y</em></li>
</ul>

</div></div><div class = 'box col col-6 bg-blue stretch col-list c2'><h3>customise <a href='http://ggplot2.tidyverse.org/reference/index.html#section-themes' title=''><em>theme</em></a> elements</h3><div class = 'box-body'>

<ul>
<li>legend &amp; guide tweaks</li>
<li>major/minor grids</li>
<li>font, faces</li>
<li>margins</li>
<li>labels &amp; ticks</li>
<li>strip positions</li>
</ul>

</div></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide><slide class=''><hgroup class = 'title-bar'><h2>programming</h2></hgroup><article  id="programming" class="smaller build">

<div class = 'box col col-6 bg-red'><h3><code>Sepal.Length</code> is not exposed</h3><div class = 'box-body'>

<div id="unnamed-chunk-67" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>iris_plot &lt;- function(flower) {
  ggplot(iris, aes(x = Species, y = flower)) +
  geom_violin() +
  ggbeeswarm::geom_quasirandom()
}
iris_plot(flower = Sepal.Length)</pre>

<pre >Warning in FUN(X[[i]], ...): restarting interrupted promise evaluation</pre>

<pre >Error in FUN(X[[i]], ...): object &#39;Sepal.Length&#39; not found</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-67-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-6 bg-red'><h3>strings does not help</h3><div class = 'box-body'>

<div id="unnamed-chunk-68" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>iris_plot &lt;- function(flower) {
  ggplot(iris, aes(x = Species, y = flower)) +
  geom_violin() +
  ggbeeswarm::geom_quasirandom()
}
iris_plot(flower = &quot;Sepal.Length&quot;)</pre>

<pre >Warning in f(...): The default behavior of beeswarm has changed in version
0.6.0. In versions &lt;0.6.0, this plot would have been dodged on the y-
axis. In versions &gt;=0.6.0, grouponX=FALSE must be explicitly set to group
on y-axis. Please set grouponX=TRUE/FALSE to avoid this warning and ensure
proper axis choice.</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-68-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-6 bg-grgold'><h3><code>aes_string()</code> expects strings</h3><div class = 'box-body'>

<div id="unnamed-chunk-69" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>iris_plot &lt;- function(flower) {
  ggplot(iris, aes_string(x = &quot;Species&quot;, y = flower)) +
  geom_violin() +
  ggbeeswarm::geom_quasirandom()
}
iris_plot(flower = &quot;Sepal.Length&quot;)</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-69-1.png' title=''/><!-- --></p></div>

</div></div><div class = 'box col col-6 bg-grgold'><h3><code>aes_string()</code> expects strings</h3><div class = 'box-body'>

<div id="unnamed-chunk-70" class="col col-12 box chunk bg-cobalt">
<pre class = 'prettyprint lang-r'>iris_plot &lt;- function(flower) {
  ggplot(iris, aes_string(x = &quot;Species&quot;, y = flower)) +
  geom_violin() +
  ggbeeswarm::geom_quasirandom()
}
iris_plot(flower = &quot;Petal.Length&quot;)</pre>

<p><img src='lecture07_plotting_files/figure-html/unnamed-chunk-70-1.png' title=''/><!-- --></p></div></article><div class = "footer"><img src="lecture07_plotting_files/logo.png"><a href='index.html'>biostat2</a></div></slide>


  <slide class="backdrop"></slide>

</slides>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
